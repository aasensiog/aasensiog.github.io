var movements=["1 2 1 2","1 2 3 2","1 2 1 4","1 2 1B 2B","1 2B 3 6","4B 6 2 3","1 1 2","1 2 3 6","1 2 1 4 5","1 2 1 6 5 6"],warning="rgb(100, 100, 0, 0.5)",danger="rgb(100, 0, 0, 0.5)",primary="rgb(0, 0, 100, 0.5)",secondary="rgb(100, 100, 100, 0.5)",grid={1:{pos:"11",badge:primary},2:{pos:"12",badge:primary},3:{pos:"10",badge:danger},4:{pos:"13",badge:danger},5:{pos:"21",badge:warning},6:{pos:"22",badge:warning},7:{pos:"01",badge:"badge-secondary"},8:{pos:"02",badge:"badge-secondary"},"1B":{pos:"41",badge:primary},"2B":{pos:"42",badge:primary},"3B":{pos:"40",badge:danger},"4B":{pos:"43",badge:danger},"5B":{pos:"51",badge:warning},"6B":{pos:"52",badge:warning}},timeleft=0;$(document).ready(function(){var a=function(){var e=document.getElementById("canvas"),n=e.getContext("2d"),t=new Image;e.width=e.width,t.src="/img/boxer.png",n.drawImage(t,0,0,400,800)},e=document.getElementById("canvas").getContext("2d"),n=new Image;n.src="/img/boxer.png",e.drawImage(n,0,0,400,800);var o=function(e,n,t){var r=e;(r-=1,e<0)?($("#work").hide(),$("#pre").show()):s(n).done(function(){setTimeout(function(){o(r,n,t)},1e3*t)})},s=function(e){var n=$.Deferred(),t=60*e;$("#progressBar").attr("max",t),timeleft=t;var r=setInterval(function(){$("#progressBar").attr("value",t-timeleft),(timeleft-=1)<=0&&clearInterval(r)},1e3);return i(random_value_from_array(movements),n),n.promise()},i=function(e,n){a(),$("#movement").html(e),t(e).done(function(){if(a(),!(0<timeleft))return $("#movement").html("Well done!"),void n.resolve();var e=random_value_from_array(movements);$("#movement").html("Prepare for..."),setTimeout(function(){$("#movement").html(e)},750),setTimeout(function(){i(e,n)},3500)})},t=function(e){var n=$.Deferred(),t=e.split(" "),r=0,o=setInterval(function(){r==t.length?(clearInterval(o),n.resolve()):(a(),function(e){var n=grid[e].pos,t=grid[e].badge,r=document.getElementById("canvas");if(r.getContext){var o=r.getContext("2d");o.fillStyle=t,o.fillRect(100*n[1],100*n[0],100,100),o.fillStyle="rgb(255, 255, 255)",o.font="72px Quicksand",o.fillText(e,100*n[1]+20,10+100*n[0]+50)}}(t[r]),r++)},1e3);return n.promise()};$("#work").hide(),$("#pre").show(),$(".rounds").click(function(){$(".rounds").removeClass("btn-info"),$(this).addClass("btn-info")}),$(".minutes_round").click(function(){$(".minutes_round").removeClass("btn-info"),$(this).addClass("btn-info")}),$(".seconds_rest_between_rounds").click(function(){$(".seconds_rest_between_rounds").removeClass("btn-info"),$(this).addClass("btn-info")}),$(".seconds_before_start").click(function(){$(".seconds_before_start").removeClass("btn-info"),$(this).addClass("btn-info")}),$("#start_btn").click(function(){$("#work").show(),$("#pre").hide();var e=$(".rounds.btn-info").val()||5,n=$(".minutes_round.btn-info").val()||3,t=$(".seconds_rest_between_rounds.btn-info").val()||30,r=$(".seconds_before_start.btn-info").val()||30;setTimeout(function(){o(e,n,t)},r)})});var random_value_from_array=function(e){return e[Math.floor(Math.random()*e.length)]};